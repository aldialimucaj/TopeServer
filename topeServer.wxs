<?xml version="1.0" encoding="utf-8"?>
<!--
    # This comment is generated by WixEdit, the specific commandline
    # arguments for the WiX Toolset are stored here.

    candleArgs: "<projectfile>" -out "<projectname>.wixobj" -ext WixUIExtension -ext WixUtilExtension -ext WixNetFxExtension
    lightArgs: "<projectname>.wixobj" -out "<projectname>.msi" -ext WixUIExtension -ext WixUtilExtension -ext WixNetFxExtension
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Product Id="611EFDF4-B339-49A0-AE1F-D1172B3878BA" Name="Tope Server" Language="1033" Version="0.0.1.1" Manufacturer="Aldi Alimucaj" UpgradeCode="DE8892D1-EE16-4A9C-8D1D-214CB77A0E73">
        <Package Description="TopeServer is a host for the Tope architecture." Comments="Tope Server" InstallerVersion="200" Compressed="yes" />
        <Media Id="1" Cabinet="simple.cab" EmbedCab="yes" />
        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFilesFolder" Name="PFiles">
                <!-- Auto-start via Registry -->
                <Component Id="AutoStartTope" Guid="0B226FD1-A57B-4CE6-A291-4642DDD2FB42">
                    <RegistryValue Id="TopeSrv.rst" Root="HKMU" Action="write" Key="Software\Microsoft\Windows\CurrentVersion\Run" Name="TopeServer" Value="[RELEASE]TopeServer.exe" Type="string" />
                    <Condition>ASSISTANCE_START_VIA_REGISTRY</Condition>
                </Component>
                <Directory Id="RELEASE" Name="TopeServer">
                    <Component Id="NANCY.DLL" DiskId="1" Guid="2C37F25C-AE5B-447C-985C-B3FF414A9913">
                        <File Id="NANCY.DLL" Name="Nancy.dll" Source="H:\Dropbox\te_ndryshme\Programming\C#\TopeServer\TopeServer\bin\Release\Nancy.dll" />
                    </Component>
                    <Component Id="NANCY.HOSTING.SELF.DLL" DiskId="1" Guid="3696268D-788A-4328-8088-BD225BD63DA5">
                        <File Id="NANCY.HOSTING.SELF.DLL" Name="Nancy.Hosting.Self.dll" Source="H:\Dropbox\te_ndryshme\Programming\C#\TopeServer\TopeServer\bin\Release\Nancy.Hosting.Self.dll" />
                    </Component>
                    <Component Id="NEWTONSOFT.JSON.DLL" DiskId="1" Guid="D4946DB5-DA83-47BF-9215-2EB6E4955D4B">
						<File Id="NEWTONSOFT.JSON.DLL" Name="Newtonsoft.Json.dll" Source="TopeServer\bin\Release\Newtonsoft.Json.dll" />
                    </Component>
                    <Component Id="NEWTONSOFT.JSON.XML" DiskId="1" Guid="1BEC5488-56D2-472B-9A21-59D4B2BEC8BC">
						<File Id="NEWTONSOFT.JSON.XML" Name="Newtonsoft.Json.xml" Source="TopeServer\bin\Release\Newtonsoft.Json.xml" />
                    </Component>
					<Component Id="TOPESERVER.EXE" DiskId="1" Guid="175581EC-D629-4AAC-AF47-F73AD1ED1D13">
                        <File Id="TOPESERVER.EXE" Name="TopeServer.exe" Source="H:\Dropbox\te_ndryshme\Programming\C#\TopeServer\TopeServer\bin\Release\TopeServer.exe">
                            <Shortcut Id="ExeShortcut" Directory="ProgramMenuDir" Name="TopeServer" Advertise="yes" Icon="StartMenuIcon.exe" IconIndex="0" />
                        </File>
                    </Component>	
                </Directory>
            </Directory>
            <Directory Id="ProgramMenuFolder">
                <Directory Id="ProgramMenuDir" Name="Tope">
                    <Component Id="StartMenuShortcuts" Guid="64B7907D-72AC-43B1-A372-E1CE30F4540E">
                        <RemoveFolder Id="ProgramMenuDir" On="uninstall" />
                        <RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Type="string" Value="" />
                        <Shortcut Id="UninstallProduct" Name="Uninstall TopeServer" Description="Uninstalls the TopeServer and removes its services." Target="[System64Folder]msiexec.exe" Arguments="/x [ProductCode]" />
                    </Component>
                </Directory>
            </Directory>
        </Directory>
        <Feature Id="DefaultFeature" Title="Main Feature" Level="1">
            <ComponentRef Id="NANCY.DLL" />
            <ComponentRef Id="NANCY.HOSTING.SELF.DLL" />
			<ComponentRef Id="NEWTONSOFT.JSON.DLL" />
			<ComponentRef Id="NEWTONSOFT.JSON.XML" />
            <ComponentRef Id="TOPESERVER.EXE" />
            <ComponentRef Id="StartMenuShortcuts" />
            <ComponentRef Id="AutoStartTope" />
        </Feature>
        <UI>
            <UIRef Id="WixUI_Minimal" />
            <Publish Dialog="ExitDialog" Control="Finish" Event="DoAction" Value="LaunchApplication">WIXUI_EXITDIALOGOPTIONALCHECKBOX = 1 and NOT Installed</Publish>
        </UI>
        <Property Id="WIXUI_EXITDIALOGOPTIONALCHECKBOXTEXT" Value="Launch Tope Server" />
        <PropertyRef Id="NETFRAMEWORK40FULL" />
        <Condition Message="This application requires .NET Framework 4.0.">Installed OR NETFRAMEWORK40FULL</Condition>
        <Icon Id="StartMenuIcon.exe" SourceFile="H:\Dropbox\te_ndryshme\Programming\C#\TopeServer\TopeServer\bin\Release\TopeServer.exe" />
        <Property Id="ASSISTANCE_START_VIA_REGISTRY">1</Property>
        <Property Id="WixShellExecTarget" Value="[RELEASE]TopeServer.exe" />
        <CustomAction Id="LaunchApplication" BinaryKey="WixCA" DllEntry="WixShellExec" Impersonate="yes" />
    </Product>
</Wix>